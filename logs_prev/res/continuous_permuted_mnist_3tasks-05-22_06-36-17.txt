[2024-05-22 06:36:17 Info] Script args: Namespace(n_tasks=3, n_classes=10, dataset='ds_cont_permuted_mnist', nn_arch='custom_cnn', logname='continuous_permuted_mnist_3tasks', results_dir='res', seed=2019, num_workers=1, num_epochs=9, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.06, mean_eta=1, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, test_freq=1, contpermuted_beta=4, optimizer='bgd', optimizer_params='{}', inference_mc=False, inference_map=False, inference_committee=True, inference_aggsoftmax=False, inference_initstd=False, committee_size=10, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc=['BGD', 'on', 'continuous', 'permuted', 'mnist'], bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=2, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019)
[2024-05-22 06:36:17 Info] Computer name: iiitd with pytorch version: 2.2.2
[2024-05-22 06:36:17 Info] Transformed model to CUDA
[2024-05-22 06:36:17 Info] Initialized 2 Conv2d layers using nn.init.xavier_normal_
[2024-05-22 06:36:17 Info] Initialized 4 linear layers using xavier
[2024-05-22 06:36:17 Info] Initialized 2 bias conv2d layers using nn.init.xavier.noraml_
[2024-05-22 06:36:17 Info] Initialized 4 bias linear layers using xavier
[2024-05-22 06:36:17 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-05-22 06:36:17 Info] BGD params: {'mean_eta': 1, 'std_init': 0.06, 'mc_iters': 10}
[2024-05-22 06:36:17 Info] Inference method: {'committee'}
[2024-05-22 06:36:17 Info] Number of parameters in the model is 592,286
[2024-05-22 06:36:17 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-05-22 06:36:17 Info] Running training from epoch 1 to epoch 9
[2024-05-22 06:36:17 Info] Training epoch number 1 with dataset number 0
[2024-05-22 06:36:23 Info] Epoch 1, train set, Iter 100 current average loss 1.4247279090583318 current average acc 0.0%
[2024-05-22 06:36:26 Info] Epoch 1, train set, Iter 200 current average loss 0.9076434544175835 current average acc 0.0%
[2024-05-22 06:36:29 Info] Epoch 1, train set, Iter 300 current average loss 0.6881158018981371 current average acc 0.0%
[2024-05-22 06:36:33 Info] Epoch 1, train set, Iter 400 current average loss 0.5627595367561993 current average acc 0.0%
[2024-05-22 06:36:37 Info] Stats for train set of size 60032, loss is 0.5029020872713699, acc is 0.0%
[2024-05-22 06:36:37 Info] Running test set for epoch number 1 for dataset idx 0 using committee
[2024-05-22 06:36:38 Info] Stats for test [committee] set of size 10000, loss is 0.11754875089868906, acc is 95.07000000000002%
[2024-05-22 06:36:38 Info] Running test set for epoch number 1 for dataset idx 1 using committee
[2024-05-22 06:36:42 Info] Stats for test [committee] set of size 10000, loss is 2.460619847145081, acc is 8.75%
[2024-05-22 06:36:42 Info] Running test set for epoch number 1 for dataset idx 2 using committee
[2024-05-22 06:36:47 Info] Stats for test [committee] set of size 10000, loss is 2.445659460411077, acc is 10.019999999999998%
[2024-05-22 06:36:47 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using committee is 37.94666666666667
[2024-05-22 06:36:47 Info] Finished epoch number 1, Took 29 seconds
[2024-05-22 06:36:47 Info] Training epoch number 2 with dataset number 0
[2024-05-22 06:36:52 Info] Epoch 2, train set, Iter 100 current average loss 0.13805465102382009 current average acc 0.0%
[2024-05-22 06:36:57 Info] Epoch 2, train set, Iter 200 current average loss 0.12737221671547694 current average acc 0.0%
[2024-05-22 06:36:59 Info] Epoch 2, train set, Iter 300 current average loss 0.11994134498573818 current average acc 0.0%
[2024-05-22 06:37:02 Info] Epoch 2, train set, Iter 400 current average loss 0.1154399660411287 current average acc 0.0%
[2024-05-22 06:37:06 Info] Stats for train set of size 60032, loss is 0.11208341299478729, acc is 0.0%
[2024-05-22 06:37:06 Info] Running test set for epoch number 2 for dataset idx 0 using committee
[2024-05-22 06:37:07 Info] Stats for test [committee] set of size 10000, loss is 0.06431668428204974, acc is 97.23999999999997%
[2024-05-22 06:37:07 Info] Running test set for epoch number 2 for dataset idx 1 using committee
[2024-05-22 06:37:08 Info] Stats for test [committee] set of size 10000, loss is 2.4770452577209463, acc is 8.480000000000002%
[2024-05-22 06:37:08 Info] Running test set for epoch number 2 for dataset idx 2 using committee
[2024-05-22 06:37:10 Info] Stats for test [committee] set of size 10000, loss is 2.4665746451950064, acc is 10.009999999999993%
[2024-05-22 06:37:10 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using committee is 38.576666666666654
[2024-05-22 06:37:10 Info] Finished epoch number 2, Took 23 seconds
[2024-05-22 06:37:10 Info] Training epoch number 3 with dataset number 0
[2024-05-22 06:37:14 Info] Epoch 3, train set, Iter 100 current average loss 0.08699002298153934 current average acc 0.0%
[2024-05-22 06:37:17 Info] Epoch 3, train set, Iter 200 current average loss 0.14249754170700893 current average acc 0.0%
[2024-05-22 06:37:20 Info] Epoch 3, train set, Iter 300 current average loss 0.2396484110578895 current average acc 0.0%
[2024-05-22 06:37:22 Info] Epoch 3, train set, Iter 400 current average loss 0.30973739838786457 current average acc 0.0%
[2024-05-22 06:37:24 Info] Stats for train set of size 60032, loss is 0.34199139739055184, acc is 0.0%
[2024-05-22 06:37:24 Info] Running test set for epoch number 3 for dataset idx 0 using committee
[2024-05-22 06:37:25 Info] Stats for test [committee] set of size 10000, loss is 0.0653736850612705, acc is 97.00000000000001%
[2024-05-22 06:37:25 Info] Running test set for epoch number 3 for dataset idx 1 using committee
[2024-05-22 06:37:27 Info] Stats for test [committee] set of size 10000, loss is 2.5644148239898725, acc is 10.590000000000003%
[2024-05-22 06:37:27 Info] Running test set for epoch number 3 for dataset idx 2 using committee
[2024-05-22 06:37:29 Info] Stats for test [committee] set of size 10000, loss is 2.522957014656062, acc is 7.389999999999997%
[2024-05-22 06:37:29 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 2 using committee is 38.32666666666667
[2024-05-22 06:37:29 Info] Finished epoch number 3, Took 18 seconds
[2024-05-22 06:37:29 Info] Training epoch number 4 with dataset number 0
[2024-05-22 06:37:33 Info] Epoch 4, train set, Iter 100 current average loss 0.5075364577472214 current average acc 0.0%
[2024-05-22 06:37:37 Info] Epoch 4, train set, Iter 200 current average loss 0.5085948682576427 current average acc 0.0%
[2024-05-22 06:37:40 Info] Epoch 4, train set, Iter 300 current average loss 0.5005424525241047 current average acc 0.0%
[2024-05-22 06:37:43 Info] Epoch 4, train set, Iter 400 current average loss 0.4938503619208929 current average acc 0.0%
[2024-05-22 06:37:45 Info] Stats for train set of size 60032, loss is 0.48699164759439095, acc is 0.0%
[2024-05-22 06:37:45 Info] Running test set for epoch number 4 for dataset idx 0 using committee
[2024-05-22 06:37:47 Info] Stats for test [committee] set of size 10000, loss is 0.10192332973031329, acc is 94.58000000000003%
[2024-05-22 06:37:47 Info] Running test set for epoch number 4 for dataset idx 1 using committee
[2024-05-22 06:37:51 Info] Stats for test [committee] set of size 10000, loss is 2.6027404489898713, acc is 11.480000000000006%
[2024-05-22 06:37:51 Info] Running test set for epoch number 4 for dataset idx 2 using committee
[2024-05-22 06:37:55 Info] Stats for test [committee] set of size 10000, loss is 2.523284154396058, acc is 8.039999999999996%
[2024-05-22 06:37:55 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 2 using committee is 38.033333333333346
[2024-05-22 06:37:55 Info] Finished epoch number 4, Took 26 seconds
[2024-05-22 06:37:55 Info] Training epoch number 5 with dataset number 0
[2024-05-22 06:38:01 Info] Epoch 5, train set, Iter 100 current average loss 0.3965791320949791 current average acc 0.0%
[2024-05-22 06:38:06 Info] Epoch 5, train set, Iter 200 current average loss 0.38206822189688594 current average acc 0.0%
[2024-05-22 06:38:12 Info] Epoch 5, train set, Iter 300 current average loss 0.37014005514482684 current average acc 0.0%
[2024-05-22 06:38:17 Info] Epoch 5, train set, Iter 400 current average loss 0.36039866070449156 current average acc 0.0%
[2024-05-22 06:38:21 Info] Stats for train set of size 60032, loss is 0.3533453182116747, acc is 0.0%
[2024-05-22 06:38:21 Info] Running test set for epoch number 5 for dataset idx 0 using committee
[2024-05-22 06:38:23 Info] Stats for test [committee] set of size 10000, loss is 0.19577480161730207, acc is 90.04999999999995%
[2024-05-22 06:38:23 Info] Running test set for epoch number 5 for dataset idx 1 using committee
[2024-05-22 06:38:25 Info] Stats for test [committee] set of size 10000, loss is 2.6275399498748806, acc is 10.09%
[2024-05-22 06:38:25 Info] Running test set for epoch number 5 for dataset idx 2 using committee
[2024-05-22 06:38:28 Info] Stats for test [committee] set of size 10000, loss is 2.5312070922470102, acc is 8.489999999999997%
[2024-05-22 06:38:28 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 2 using committee is 36.20999999999999
[2024-05-22 06:38:28 Info] Finished epoch number 5, Took 32 seconds
[2024-05-22 06:38:28 Info] Training epoch number 6 with dataset number 0
[2024-05-22 06:38:34 Info] Epoch 6, train set, Iter 100 current average loss 0.3138278603851796 current average acc 0.0%
[2024-05-22 06:38:38 Info] Epoch 6, train set, Iter 200 current average loss 0.36252201937884143 current average acc 0.0%
[2024-05-22 06:38:43 Info] Epoch 6, train set, Iter 300 current average loss 0.4216982909490669 current average acc 0.0%
[2024-05-22 06:38:49 Info] Epoch 6, train set, Iter 400 current average loss 0.45368668213114266 current average acc 0.0%
[2024-05-22 06:38:52 Info] Stats for train set of size 60032, loss is 0.4641437345444534, acc is 0.0%
[2024-05-22 06:38:52 Info] Running test set for epoch number 6 for dataset idx 0 using committee
[2024-05-22 06:38:53 Info] Stats for test [committee] set of size 10000, loss is 0.37138322977602484, acc is 79.28000000000003%
[2024-05-22 06:38:53 Info] Running test set for epoch number 6 for dataset idx 1 using committee
[2024-05-22 06:38:56 Info] Stats for test [committee] set of size 10000, loss is 2.611181934432982, acc is 9.670000000000002%
[2024-05-22 06:38:56 Info] Running test set for epoch number 6 for dataset idx 2 using committee
[2024-05-22 06:38:58 Info] Stats for test [committee] set of size 10000, loss is 2.6055067563629204, acc is 4.520000000000002%
[2024-05-22 06:38:58 Info] Average accuracy over all tasks for epoch number 6 for dataset idx 2 using committee is 31.156666666666677
[2024-05-22 06:38:58 Info] Finished epoch number 6, Took 30 seconds
[2024-05-22 06:38:58 Info] Training epoch number 7 with dataset number 0
[2024-05-22 06:39:04 Info] Epoch 7, train set, Iter 100 current average loss 0.5041289672851565 current average acc 0.0%
[2024-05-22 06:39:09 Info] Epoch 7, train set, Iter 200 current average loss 0.4955950605943803 current average acc 0.0%
[2024-05-22 06:39:14 Info] Epoch 7, train set, Iter 300 current average loss 0.48648003762960396 current average acc 0.0%
[2024-05-22 06:39:19 Info] Epoch 7, train set, Iter 400 current average loss 0.46829319170117356 current average acc 0.0%
[2024-05-22 06:39:23 Info] Stats for train set of size 60032, loss is 0.4556854732795311, acc is 0.0%
[2024-05-22 06:39:23 Info] Running test set for epoch number 7 for dataset idx 0 using committee
[2024-05-22 06:39:25 Info] Stats for test [committee] set of size 10000, loss is 0.7236336892235283, acc is 65.45000000000002%
[2024-05-22 06:39:25 Info] Running test set for epoch number 7 for dataset idx 1 using committee
[2024-05-22 06:39:29 Info] Stats for test [committee] set of size 10000, loss is 2.596038705596919, acc is 10.329999999999998%
[2024-05-22 06:39:29 Info] Running test set for epoch number 7 for dataset idx 2 using committee
[2024-05-22 06:39:33 Info] Stats for test [committee] set of size 10000, loss is 2.7143337393951406, acc is 4.680000000000004%
[2024-05-22 06:39:33 Info] Average accuracy over all tasks for epoch number 7 for dataset idx 2 using committee is 26.820000000000007
[2024-05-22 06:39:33 Info] Finished epoch number 7, Took 35 seconds
[2024-05-22 06:39:33 Info] Training epoch number 8 with dataset number 0
[2024-05-22 06:39:37 Info] Epoch 8, train set, Iter 100 current average loss 0.3550595225691803 current average acc 0.0%
[2024-05-22 06:39:39 Info] Epoch 8, train set, Iter 200 current average loss 0.3343162516728044 current average acc 0.0%
[2024-05-22 06:39:43 Info] Epoch 8, train set, Iter 300 current average loss 0.3302573373367377 current average acc 0.0%
[2024-05-22 06:39:48 Info] Epoch 8, train set, Iter 400 current average loss 0.32396396874636413 current average acc 0.0%
[2024-05-22 06:39:51 Info] Stats for train set of size 60032, loss is 0.3187079944494942, acc is 0.0%
[2024-05-22 06:39:51 Info] Running test set for epoch number 8 for dataset idx 0 using committee
[2024-05-22 06:39:52 Info] Stats for test [committee] set of size 10000, loss is 0.9204776489186288, acc is 58.849999999999994%
[2024-05-22 06:39:52 Info] Running test set for epoch number 8 for dataset idx 1 using committee
[2024-05-22 06:39:56 Info] Stats for test [committee] set of size 10000, loss is 2.5692916229629486, acc is 10.700000000000003%
[2024-05-22 06:39:56 Info] Running test set for epoch number 8 for dataset idx 2 using committee
[2024-05-22 06:40:01 Info] Stats for test [committee] set of size 10000, loss is 2.7339739755248984, acc is 4.67%
[2024-05-22 06:40:01 Info] Average accuracy over all tasks for epoch number 8 for dataset idx 2 using committee is 24.740000000000002
[2024-05-22 06:40:01 Info] Finished epoch number 8, Took 27 seconds
[2024-05-22 06:40:01 Info] Training epoch number 9 with dataset number 0
[2024-05-22 06:40:07 Info] Epoch 9, train set, Iter 100 current average loss 0.27612985917925853 current average acc 0.0%
[2024-05-22 06:40:12 Info] Epoch 9, train set, Iter 200 current average loss 0.267894399777055 current average acc 0.0%
[2024-05-22 06:40:17 Info] Epoch 9, train set, Iter 300 current average loss 0.2626445398305857 current average acc 0.0%
[2024-05-22 06:40:21 Info] Epoch 9, train set, Iter 400 current average loss 0.2607611829806126 current average acc 0.0%
[2024-05-22 06:40:24 Info] Stats for train set of size 60032, loss is 0.25724636264669654, acc is 0.0%
[2024-05-22 06:40:24 Info] Running test set for epoch number 9 for dataset idx 0 using committee
[2024-05-22 06:40:26 Info] Stats for test [committee] set of size 10000, loss is 1.1182927031183247, acc is 56.96%
[2024-05-22 06:40:26 Info] Running test set for epoch number 9 for dataset idx 1 using committee
[2024-05-22 06:40:30 Info] Stats for test [committee] set of size 10000, loss is 2.56917970436096, acc is 10.81%
[2024-05-22 06:40:30 Info] Running test set for epoch number 9 for dataset idx 2 using committee
[2024-05-22 06:40:32 Info] Stats for test [committee] set of size 10000, loss is 2.763972121009828, acc is 3.6499999999999977%
[2024-05-22 06:40:32 Info] Average accuracy over all tasks for epoch number 9 for dataset idx 2 using committee is 23.806666666666665
[2024-05-22 06:40:32 Info] Finished epoch number 9, Took 31 seconds
