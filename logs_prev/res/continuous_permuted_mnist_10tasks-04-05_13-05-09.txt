[2024-04-05 13:05:09 Info] Script args: Namespace(dataset='ds_padded_cont_permuted_mnist', nn_arch='mnist_simple_net_200width_domainlearning_1024input_10cls_1ds', logname='continuous_permuted_mnist_10tasks', results_dir='res', seed=2019, num_workers=1, num_epochs=15, batch_size=64, pruning_percents=[], train_mc_iters=10, std_init=0.06, mean_eta=1, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, test_freq=10, contpermuted_beta=4, optimizer='bgd', optimizer_params='{}', inference_mc=True, inference_map=True, inference_committee=True, inference_aggsoftmax=True, inference_initstd=True, committee_size=10, test_mc_iters=10, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc=['BGD', 'on', 'continuous', 'permuted', 'mnist'], bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=2, iterations_per_virtual_epc=938, separate_labels_space=False, permute_seed=2019)
[2024-04-05 13:05:09 Info] Computer name: iiitd with pytorch version: 2.2.2
[2024-04-05 13:05:09 Info] Transformed model to CUDA
[2024-04-05 13:05:09 Info] Initialized 0 Conv2d layers using nn.init.xavier_normal_
[2024-04-05 13:05:09 Info] Initialized 3 linear layers using xavier
[2024-04-05 13:05:09 Info] Initialized 0 bias conv2d layers using nn.init.xavier.noraml_
[2024-04-05 13:05:09 Info] Initialized 3 bias linear layers using xavier
[2024-04-05 13:05:09 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-04-05 13:05:09 Info] BGD params: {'mean_eta': 1, 'std_init': 0.06, 'mc_iters': 10}
[2024-04-05 13:05:09 Info] Inference method: {'test_mc', 'init_std', 'map', 'committee', 'agg_softmax'}
[2024-04-05 13:05:09 Info] Number of parameters in the model is 247,210
[2024-04-05 13:05:09 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-04-05 13:05:09 Info] Running training from epoch 1 to epoch 15
[2024-04-05 13:05:09 Info] Training epoch number 1 with dataset number 0
[2024-04-05 13:05:13 Info] Epoch 1, train set, Iter 100 current average loss 1.0007363820523008 current average acc 0.0%
[2024-04-05 13:05:16 Info] Epoch 1, train set, Iter 200 current average loss 0.7048330916203566 current average acc 0.0%
[2024-04-05 13:05:19 Info] Epoch 1, train set, Iter 300 current average loss 0.5797222898751495 current average acc 0.0%
[2024-04-05 13:05:22 Info] Epoch 1, train set, Iter 400 current average loss 0.5002934888256725 current average acc 0.0%
[2024-04-05 13:05:25 Info] Epoch 1, train set, Iter 500 current average loss 0.44965224900990824 current average acc 0.0%
[2024-04-05 13:05:27 Info] Epoch 1, train set, Iter 600 current average loss 0.4109567244127397 current average acc 0.0%
[2024-04-05 13:05:30 Info] Epoch 1, train set, Iter 700 current average loss 0.38264512789941274 current average acc 0.0%
[2024-04-05 13:05:32 Info] Epoch 1, train set, Iter 800 current average loss 0.35936660168133727 current average acc 0.0%
[2024-04-05 13:05:35 Info] Epoch 1, train set, Iter 900 current average loss 0.341528598412666 current average acc 0.0%
[2024-04-05 13:05:36 Info] Stats for train set of size 60032, loss is 0.3351179114666035, acc is 0.0%
[2024-04-05 13:05:36 Info] Running test set for epoch number 1 for dataset idx 0 using test_mc
[2024-04-05 13:05:38 Info] Stats for test [test_mc] set of size 10000, loss is 0.17869361425891497, acc is 94.38199999999979%
[2024-04-05 13:05:38 Info] Running test set for epoch number 1 for dataset idx 1 using test_mc
[2024-04-05 13:05:40 Info] Stats for test [test_mc] set of size 10000, loss is 3.99558230178833, acc is 9.293999999999981%
[2024-04-05 13:05:40 Info] Running test set for epoch number 1 for dataset idx 2 using test_mc
[2024-04-05 13:05:43 Info] Stats for test [test_mc] set of size 10000, loss is 4.284715390357973, acc is 8.613000000000005%
[2024-04-05 13:05:43 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using test_mc is 37.42966666666659
[2024-04-05 13:05:43 Info] Running test set for epoch number 1 for dataset idx 0 using init_std
[2024-04-05 13:05:45 Info] Stats for test [init_std] set of size 10000, loss is 0.2456667280295487, acc is 92.2479999999998%
[2024-04-05 13:05:45 Info] Running test set for epoch number 1 for dataset idx 1 using init_std
[2024-04-05 13:05:47 Info] Stats for test [init_std] set of size 10000, loss is 4.157701592140208, acc is 9.314%
[2024-04-05 13:05:47 Info] Running test set for epoch number 1 for dataset idx 2 using init_std
[2024-04-05 13:05:50 Info] Stats for test [init_std] set of size 10000, loss is 4.432694120330798, acc is 8.786999999999981%
[2024-04-05 13:05:50 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using init_std is 36.78299999999993
[2024-04-05 13:05:50 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-04-05 13:05:52 Info] Stats for test [map] set of size 10000, loss is 0.13226103164963432, acc is 95.81999999999998%
[2024-04-05 13:05:52 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-04-05 13:05:54 Info] Stats for test [map] set of size 10000, loss is 2.997184020614624, acc is 9.169999999999991%
[2024-04-05 13:05:54 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-04-05 13:05:57 Info] Stats for test [map] set of size 10000, loss is 3.252404331207275, acc is 8.719999999999994%
[2024-04-05 13:05:57 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using map is 37.90333333333332
[2024-04-05 13:05:57 Info] Running test set for epoch number 1 for dataset idx 0 using committee
[2024-04-05 13:05:59 Info] Stats for test [committee] set of size 10000, loss is 0.17758915497392402, acc is 92.24999999999999%
[2024-04-05 13:05:59 Info] Running test set for epoch number 1 for dataset idx 1 using committee
[2024-04-05 13:06:01 Info] Stats for test [committee] set of size 10000, loss is 4.001033912277233, acc is 11.579999999999995%
[2024-04-05 13:06:01 Info] Running test set for epoch number 1 for dataset idx 2 using committee
[2024-04-05 13:06:04 Info] Stats for test [committee] set of size 10000, loss is 4.284084501342795, acc is 11.579999999999995%
[2024-04-05 13:06:04 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using committee is 38.46999999999999
[2024-04-05 13:06:04 Info] Running test set for epoch number 1 for dataset idx 0 using agg_softmax
[2024-04-05 13:06:05 Info] Stats for test [agg_softmax] set of size 10000, loss is 0.1774148844542356, acc is 95.75%
[2024-04-05 13:06:05 Info] Running test set for epoch number 1 for dataset idx 1 using agg_softmax
[2024-04-05 13:06:08 Info] Stats for test [agg_softmax] set of size 10000, loss is 3.9949377775955215, acc is 9.069999999999999%
[2024-04-05 13:06:08 Info] Running test set for epoch number 1 for dataset idx 2 using agg_softmax
[2024-04-05 13:06:11 Info] Stats for test [agg_softmax] set of size 10000, loss is 4.283068232688913, acc is 8.569999999999995%
[2024-04-05 13:06:11 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using agg_softmax is 37.79666666666666
[2024-04-05 13:06:11 Info] Finished epoch number 1, Took 61 seconds
[2024-04-05 13:06:11 Info] Training epoch number 2 with dataset number 0
[2024-04-05 13:06:14 Info] Epoch 2, train set, Iter 100 current average loss 0.17528511757496743 current average acc 0.0%
[2024-04-05 13:06:15 Info] Epoch 2, train set, Iter 200 current average loss 0.16925115499040114 current average acc 0.0%
[2024-04-05 13:06:17 Info] Epoch 2, train set, Iter 300 current average loss 0.16315139764112688 current average acc 0.0%
[2024-04-05 13:06:18 Info] Epoch 2, train set, Iter 400 current average loss 0.16043116903630944 current average acc 0.0%
[2024-04-05 13:06:19 Info] Epoch 2, train set, Iter 500 current average loss 0.15838263752777088 current average acc 0.0%
[2024-04-05 13:06:21 Info] Epoch 2, train set, Iter 600 current average loss 0.15533829572175914 current average acc 0.0%
[2024-04-05 13:06:22 Info] Epoch 2, train set, Iter 700 current average loss 0.15209659468409142 current average acc 0.0%
[2024-04-05 13:06:25 Info] Epoch 2, train set, Iter 800 current average loss 0.1507431308946098 current average acc 0.0%
[2024-04-05 13:06:26 Info] Epoch 2, train set, Iter 900 current average loss 0.14684927945506449 current average acc 0.0%
[2024-04-05 13:06:26 Info] Stats for train set of size 60032, loss is 0.14609279371922163, acc is 0.0%
[2024-04-05 13:06:26 Info] Running test set for epoch number 2 for dataset idx 0 using test_mc
[2024-04-05 13:06:28 Info] Stats for test [test_mc] set of size 10000, loss is 0.13331661052634947, acc is 95.83399999999983%
[2024-04-05 13:06:28 Info] Running test set for epoch number 2 for dataset idx 1 using test_mc
[2024-04-05 13:06:31 Info] Stats for test [test_mc] set of size 10000, loss is 4.184718720932001, acc is 9.152000000000013%
[2024-04-05 13:06:31 Info] Running test set for epoch number 2 for dataset idx 2 using test_mc
[2024-04-05 13:06:33 Info] Stats for test [test_mc] set of size 10000, loss is 4.324181225967406, acc is 8.679000000000011%
[2024-04-05 13:06:33 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using test_mc is 37.888333333333286
[2024-04-05 13:06:33 Info] Running test set for epoch number 2 for dataset idx 0 using init_std
[2024-04-05 13:06:35 Info] Stats for test [init_std] set of size 10000, loss is 0.20683043310899224, acc is 93.55599999999993%
[2024-04-05 13:06:35 Info] Running test set for epoch number 2 for dataset idx 1 using init_std
[2024-04-05 13:06:38 Info] Stats for test [init_std] set of size 10000, loss is 4.421549669265757, acc is 9.092000000000022%
[2024-04-05 13:06:38 Info] Running test set for epoch number 2 for dataset idx 2 using init_std
[2024-04-05 13:06:40 Info] Stats for test [init_std] set of size 10000, loss is 4.548625964088444, acc is 8.803999999999954%
[2024-04-05 13:06:40 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using init_std is 37.15066666666664
[2024-04-05 13:06:40 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-04-05 13:06:42 Info] Stats for test [map] set of size 10000, loss is 0.10091113326735794, acc is 96.81%
[2024-04-05 13:06:42 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-04-05 13:06:44 Info] Stats for test [map] set of size 10000, loss is 3.2030534713745094, acc is 8.749999999999993%
[2024-04-05 13:06:44 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-04-05 13:06:47 Info] Stats for test [map] set of size 10000, loss is 3.3181849105834953, acc is 8.369999999999997%
[2024-04-05 13:06:47 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using map is 37.97666666666667
[2024-04-05 13:06:47 Info] Running test set for epoch number 2 for dataset idx 0 using committee
[2024-04-05 13:06:49 Info] Stats for test [committee] set of size 10000, loss is 0.13143586404787397, acc is 94.21000000000002%
[2024-04-05 13:06:49 Info] Running test set for epoch number 2 for dataset idx 1 using committee
[2024-04-05 13:06:51 Info] Stats for test [committee] set of size 10000, loss is 4.176227742233287, acc is 11.33%
[2024-04-05 13:06:51 Info] Running test set for epoch number 2 for dataset idx 2 using committee
[2024-04-05 13:06:54 Info] Stats for test [committee] set of size 10000, loss is 4.303313900642397, acc is 11.089999999999993%
[2024-04-05 13:06:54 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using committee is 38.87666666666667
[2024-04-05 13:06:54 Info] Running test set for epoch number 2 for dataset idx 0 using agg_softmax
[2024-04-05 13:06:56 Info] Stats for test [agg_softmax] set of size 10000, loss is 0.13501637194979904, acc is 96.70999999999997%
[2024-04-05 13:06:56 Info] Running test set for epoch number 2 for dataset idx 1 using agg_softmax
[2024-04-05 13:06:58 Info] Stats for test [agg_softmax] set of size 10000, loss is 4.177488220214849, acc is 9.269999999999998%
[2024-04-05 13:06:58 Info] Running test set for epoch number 2 for dataset idx 2 using agg_softmax
[2024-04-05 13:07:01 Info] Stats for test [agg_softmax] set of size 10000, loss is 4.295093712883002, acc is 8.77000000000001%
[2024-04-05 13:07:01 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using agg_softmax is 38.24999999999999
