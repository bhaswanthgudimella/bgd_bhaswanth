[2024-05-22 07:28:44 Info] Script args: Namespace(n_tasks=3, n_classes=10, dataset='ds_cont_permuted_mnist', nn_arch='custom_cnn', logname='continuous_permuted_mnist_3tasks', results_dir='res', seed=2019, num_workers=1, num_epochs=9, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.06, mean_eta=1, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, test_freq=1, contpermuted_beta=4, optimizer='bgd', optimizer_params='{}', inference_mc=False, inference_map=True, inference_committee=False, inference_aggsoftmax=False, inference_initstd=False, committee_size=0, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc=['BGD', 'on', 'continuous', 'permuted', 'mnist'], bw_to_rgb=False, permuted_offset=False, labels_trick=True, num_of_permutations=2, iterations_per_virtual_epc=469, separate_labels_space=True, permute_seed=2019)
[2024-05-22 07:28:44 Info] Computer name: iiitd with pytorch version: 2.2.2
[2024-05-22 07:28:44 Info] Transformed model to CUDA
[2024-05-22 07:28:44 Info] Initialized 2 Conv2d layers using nn.init.xavier_normal_
[2024-05-22 07:28:44 Info] Initialized 4 linear layers using xavier
[2024-05-22 07:28:44 Info] Initialized 2 bias conv2d layers using nn.init.xavier.noraml_
[2024-05-22 07:28:44 Info] Initialized 4 bias linear layers using xavier
[2024-05-22 07:28:44 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-05-22 07:28:44 Info] BGD params: {'mean_eta': 1, 'std_init': 0.06, 'mc_iters': 10}
[2024-05-22 07:28:44 Info] Inference method: {'map'}
[2024-05-22 07:28:44 Info] Number of parameters in the model is 592,286
[2024-05-22 07:28:44 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-05-22 07:28:44 Info] Running training from epoch 1 to epoch 9
[2024-05-22 07:28:44 Info] Training epoch number 1 with dataset number 0
[2024-05-22 07:28:51 Info] Epoch 1, train set, Iter 100 current average loss 1.4185721103399986 current average acc 0.0%
[2024-05-22 07:28:56 Info] Epoch 1, train set, Iter 200 current average loss 0.8955396216660718 current average acc 0.0%
[2024-05-22 07:29:01 Info] Epoch 1, train set, Iter 300 current average loss 0.6747286963065465 current average acc 0.0%
[2024-05-22 07:29:07 Info] Epoch 1, train set, Iter 400 current average loss 0.5512198142409331 current average acc 0.0%
[2024-05-22 07:29:10 Info] Stats for train set of size 60032, loss is 0.49247982502778137, acc is 0.0%
[2024-05-22 07:29:10 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-05-22 07:29:11 Info] Stats for test [map] set of size 10000, loss is 0.09212035085260871, acc is 97.05999999999995%
[2024-05-22 07:29:11 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-05-22 07:29:13 Info] Stats for test [map] set of size 10000, loss is 2.414879470443727, acc is 8.530000000000005%
[2024-05-22 07:29:13 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-05-22 07:29:17 Info] Stats for test [map] set of size 10000, loss is 2.399914904403688, acc is 9.980000000000006%
[2024-05-22 07:29:17 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using map is 38.52333333333332
[2024-05-22 07:29:17 Info] Finished epoch number 1, Took 33 seconds
[2024-05-22 07:29:17 Info] Training epoch number 2 with dataset number 0
[2024-05-22 07:29:23 Info] Epoch 2, train set, Iter 100 current average loss 0.1365349297039212 current average acc 0.0%
[2024-05-22 07:29:28 Info] Epoch 2, train set, Iter 200 current average loss 0.126667426891625 current average acc 0.0%
[2024-05-22 07:29:33 Info] Epoch 2, train set, Iter 300 current average loss 0.1193126282300802 current average acc 0.0%
[2024-05-22 07:29:35 Info] Epoch 2, train set, Iter 400 current average loss 0.11489315301459287 current average acc 0.0%
[2024-05-22 07:29:37 Info] Stats for train set of size 60032, loss is 0.1112009547607128, acc is 0.0%
[2024-05-22 07:29:37 Info] Running test set for epoch number 2 for dataset idx 0 using map
[2024-05-22 07:29:38 Info] Stats for test [map] set of size 10000, loss is 0.0545343789911829, acc is 98.27000000000002%
[2024-05-22 07:29:38 Info] Running test set for epoch number 2 for dataset idx 1 using map
[2024-05-22 07:29:42 Info] Stats for test [map] set of size 10000, loss is 2.409828353500365, acc is 8.249999999999995%
[2024-05-22 07:29:42 Info] Running test set for epoch number 2 for dataset idx 2 using map
[2024-05-22 07:29:43 Info] Stats for test [map] set of size 10000, loss is 2.4059375267028815, acc is 9.860000000000003%
[2024-05-22 07:29:43 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using map is 38.793333333333344
[2024-05-22 07:29:43 Info] Finished epoch number 2, Took 26 seconds
[2024-05-22 07:29:43 Info] Training epoch number 3 with dataset number 0
[2024-05-22 07:29:49 Info] Epoch 3, train set, Iter 100 current average loss 0.08616482504922902 current average acc 0.0%
[2024-05-22 07:29:55 Info] Epoch 3, train set, Iter 200 current average loss 0.14272458332544202 current average acc 0.0%
[2024-05-22 07:30:00 Info] Epoch 3, train set, Iter 300 current average loss 0.24004628312929238 current average acc 0.0%
[2024-05-22 07:30:05 Info] Epoch 3, train set, Iter 400 current average loss 0.3096413639213425 current average acc 0.0%
[2024-05-22 07:30:08 Info] Stats for train set of size 60032, loss is 0.34208391402413135, acc is 0.0%
[2024-05-22 07:30:08 Info] Running test set for epoch number 3 for dataset idx 0 using map
[2024-05-22 07:30:10 Info] Stats for test [map] set of size 10000, loss is 0.05110068336455153, acc is 98.43999999999997%
[2024-05-22 07:30:10 Info] Running test set for epoch number 3 for dataset idx 1 using map
[2024-05-22 07:30:14 Info] Stats for test [map] set of size 10000, loss is 2.435577387619019, acc is 10.01999999999999%
[2024-05-22 07:30:14 Info] Running test set for epoch number 3 for dataset idx 2 using map
[2024-05-22 07:30:18 Info] Stats for test [map] set of size 10000, loss is 2.4211558872222896, acc is 10.260000000000002%
[2024-05-22 07:30:18 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 2 using map is 39.57333333333332
[2024-05-22 07:30:18 Info] Finished epoch number 3, Took 34 seconds
[2024-05-22 07:30:18 Info] Training epoch number 4 with dataset number 0
[2024-05-22 07:30:24 Info] Epoch 4, train set, Iter 100 current average loss 0.4962019214928151 current average acc 0.0%
[2024-05-22 07:30:30 Info] Epoch 4, train set, Iter 200 current average loss 0.4982688500881201 current average acc 0.0%
[2024-05-22 07:30:35 Info] Epoch 4, train set, Iter 300 current average loss 0.4925605676869553 current average acc 0.0%
[2024-05-22 07:30:40 Info] Epoch 4, train set, Iter 400 current average loss 0.48569987934827813 current average acc 0.0%
[2024-05-22 07:30:44 Info] Stats for train set of size 60032, loss is 0.4789961629902626, acc is 0.0%
[2024-05-22 07:30:44 Info] Running test set for epoch number 4 for dataset idx 0 using map
[2024-05-22 07:30:45 Info] Stats for test [map] set of size 10000, loss is 0.06594060738459233, acc is 98.03999999999999%
[2024-05-22 07:30:45 Info] Running test set for epoch number 4 for dataset idx 1 using map
[2024-05-22 07:30:46 Info] Stats for test [map] set of size 10000, loss is 2.416584678649902, acc is 12.510000000000007%
[2024-05-22 07:30:46 Info] Running test set for epoch number 4 for dataset idx 2 using map
[2024-05-22 07:30:48 Info] Stats for test [map] set of size 10000, loss is 2.427741632843017, acc is 10.379999999999999%
[2024-05-22 07:30:48 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 2 using map is 40.31
[2024-05-22 07:30:48 Info] Finished epoch number 4, Took 30 seconds
[2024-05-22 07:30:48 Info] Training epoch number 5 with dataset number 0
[2024-05-22 07:30:51 Info] Epoch 5, train set, Iter 100 current average loss 0.39175108081102383 current average acc 0.0%
[2024-05-22 07:30:55 Info] Epoch 5, train set, Iter 200 current average loss 0.3762630864903318 current average acc 0.0%
[2024-05-22 07:31:01 Info] Epoch 5, train set, Iter 300 current average loss 0.36370122398435933 current average acc 0.0%
[2024-05-22 07:31:06 Info] Epoch 5, train set, Iter 400 current average loss 0.3542171944044522 current average acc 0.0%
[2024-05-22 07:31:10 Info] Stats for train set of size 60032, loss is 0.3478594472000342, acc is 0.0%
[2024-05-22 07:31:10 Info] Running test set for epoch number 5 for dataset idx 0 using map
[2024-05-22 07:31:10 Info] Stats for test [map] set of size 10000, loss is 0.10114001684263343, acc is 96.99%
[2024-05-22 07:31:10 Info] Running test set for epoch number 5 for dataset idx 1 using map
[2024-05-22 07:31:12 Info] Stats for test [map] set of size 10000, loss is 2.4226268081665063, acc is 11.930000000000003%
[2024-05-22 07:31:12 Info] Running test set for epoch number 5 for dataset idx 2 using map
[2024-05-22 07:31:16 Info] Stats for test [map] set of size 10000, loss is 2.4205387218475347, acc is 9.770000000000001%
[2024-05-22 07:31:16 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 2 using map is 39.56333333333333
[2024-05-22 07:31:16 Info] Finished epoch number 5, Took 28 seconds
[2024-05-22 07:31:16 Info] Training epoch number 6 with dataset number 0
[2024-05-22 07:31:22 Info] Epoch 6, train set, Iter 100 current average loss 0.30839156705141046 current average acc 0.0%
[2024-05-22 07:31:28 Info] Epoch 6, train set, Iter 200 current average loss 0.3601274542435999 current average acc 0.0%
[2024-05-22 07:31:33 Info] Epoch 6, train set, Iter 300 current average loss 0.42170315635701006 current average acc 0.0%
[2024-05-22 07:31:37 Info] Epoch 6, train set, Iter 400 current average loss 0.4563567211814219 current average acc 0.0%
[2024-05-22 07:31:39 Info] Stats for train set of size 60032, loss is 0.46849076122935085, acc is 0.0%
[2024-05-22 07:31:39 Info] Running test set for epoch number 6 for dataset idx 0 using map
[2024-05-22 07:31:40 Info] Stats for test [map] set of size 10000, loss is 0.2230374999493359, acc is 93.20000000000002%
[2024-05-22 07:31:40 Info] Running test set for epoch number 6 for dataset idx 1 using map
[2024-05-22 07:31:42 Info] Stats for test [map] set of size 10000, loss is 2.432992449569703, acc is 8.63%
[2024-05-22 07:31:42 Info] Running test set for epoch number 6 for dataset idx 2 using map
[2024-05-22 07:31:46 Info] Stats for test [map] set of size 10000, loss is 2.4965396648406974, acc is 11.439999999999996%
[2024-05-22 07:31:46 Info] Average accuracy over all tasks for epoch number 6 for dataset idx 2 using map is 37.75666666666667
[2024-05-22 07:31:46 Info] Finished epoch number 6, Took 29 seconds
[2024-05-22 07:31:46 Info] Training epoch number 7 with dataset number 0
[2024-05-22 07:31:52 Info] Epoch 7, train set, Iter 100 current average loss 0.5049382160007944 current average acc 0.0%
[2024-05-22 07:31:57 Info] Epoch 7, train set, Iter 200 current average loss 0.49525310233235326 current average acc 0.0%
[2024-05-22 07:32:02 Info] Epoch 7, train set, Iter 300 current average loss 0.4858702775438628 current average acc 0.0%
[2024-05-22 07:32:08 Info] Epoch 7, train set, Iter 400 current average loss 0.46773148370906764 current average acc 0.0%
[2024-05-22 07:32:12 Info] Stats for train set of size 60032, loss is 0.454504250787469, acc is 0.0%
[2024-05-22 07:32:12 Info] Running test set for epoch number 7 for dataset idx 0 using map
[2024-05-22 07:32:13 Info] Stats for test [map] set of size 10000, loss is 0.4855294076681142, acc is 84.80000000000005%
[2024-05-22 07:32:13 Info] Running test set for epoch number 7 for dataset idx 1 using map
[2024-05-22 07:32:17 Info] Stats for test [map] set of size 10000, loss is 2.420552708053589, acc is 7.8%
[2024-05-22 07:32:17 Info] Running test set for epoch number 7 for dataset idx 2 using map
[2024-05-22 07:32:21 Info] Stats for test [map] set of size 10000, loss is 2.562177206420898, acc is 11.360000000000003%
[2024-05-22 07:32:21 Info] Average accuracy over all tasks for epoch number 7 for dataset idx 2 using map is 34.65333333333335
[2024-05-22 07:32:21 Info] Finished epoch number 7, Took 35 seconds
[2024-05-22 07:32:21 Info] Training epoch number 8 with dataset number 0
[2024-05-22 07:32:27 Info] Epoch 8, train set, Iter 100 current average loss 0.35116353851556753 current average acc 0.0%
[2024-05-22 07:32:32 Info] Epoch 8, train set, Iter 200 current average loss 0.33125785119831563 current average acc 0.0%
[2024-05-22 07:32:37 Info] Epoch 8, train set, Iter 300 current average loss 0.32870431029300073 current average acc 0.0%
[2024-05-22 07:32:43 Info] Epoch 8, train set, Iter 400 current average loss 0.3220623180456469 current average acc 0.0%
[2024-05-22 07:32:46 Info] Stats for train set of size 60032, loss is 0.3162200135478727, acc is 0.0%
[2024-05-22 07:32:46 Info] Running test set for epoch number 8 for dataset idx 0 using map
[2024-05-22 07:32:48 Info] Stats for test [map] set of size 10000, loss is 0.5861353813409803, acc is 81.50999999999998%
[2024-05-22 07:32:48 Info] Running test set for epoch number 8 for dataset idx 1 using map
[2024-05-22 07:32:52 Info] Stats for test [map] set of size 10000, loss is 2.413205240249636, acc is 6.93%
[2024-05-22 07:32:52 Info] Running test set for epoch number 8 for dataset idx 2 using map
[2024-05-22 07:32:56 Info] Stats for test [map] set of size 10000, loss is 2.5824566814422614, acc is 11.149999999999995%
[2024-05-22 07:32:56 Info] Average accuracy over all tasks for epoch number 8 for dataset idx 2 using map is 33.19666666666666
[2024-05-22 07:32:56 Info] Finished epoch number 8, Took 35 seconds
[2024-05-22 07:32:56 Info] Training epoch number 9 with dataset number 0
[2024-05-22 07:33:02 Info] Epoch 9, train set, Iter 100 current average loss 0.2719130205959092 current average acc 0.0%
[2024-05-22 07:33:07 Info] Epoch 9, train set, Iter 200 current average loss 0.2652639052793387 current average acc 0.0%
[2024-05-22 07:33:13 Info] Epoch 9, train set, Iter 300 current average loss 0.2622228650848074 current average acc 0.0%
[2024-05-22 07:33:18 Info] Epoch 9, train set, Iter 400 current average loss 0.2595747076589608 current average acc 0.0%
[2024-05-22 07:33:22 Info] Stats for train set of size 60032, loss is 0.2552198102971756, acc is 0.0%
[2024-05-22 07:33:22 Info] Running test set for epoch number 9 for dataset idx 0 using map
[2024-05-22 07:33:23 Info] Stats for test [map] set of size 10000, loss is 0.7245920867919925, acc is 77.60000000000002%
[2024-05-22 07:33:23 Info] Running test set for epoch number 9 for dataset idx 1 using map
[2024-05-22 07:33:28 Info] Stats for test [map] set of size 10000, loss is 2.409927235794068, acc is 7.549999999999999%
[2024-05-22 07:33:28 Info] Running test set for epoch number 9 for dataset idx 2 using map
[2024-05-22 07:33:31 Info] Stats for test [map] set of size 10000, loss is 2.597092004013062, acc is 10.309999999999997%
[2024-05-22 07:33:31 Info] Average accuracy over all tasks for epoch number 9 for dataset idx 2 using map is 31.820000000000007
[2024-05-22 07:33:31 Info] Finished epoch number 9, Took 34 seconds
