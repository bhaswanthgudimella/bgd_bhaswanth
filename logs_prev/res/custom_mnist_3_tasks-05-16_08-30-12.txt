[2024-05-16 08:30:12 Info] Script args: Namespace(n_tasks=3, n_classes=10, dataset='ds_cont_permuted_mnist', nn_arch='custom_cnn', logname='custom_mnist_3_tasks', results_dir='res', seed=2019, num_workers=1, num_epochs=60, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.06, mean_eta=1, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, test_freq=10, contpermuted_beta=4, optimizer='bgd', optimizer_params='{}', inference_mc=True, inference_map=True, inference_committee=True, inference_aggsoftmax=True, inference_initstd=True, committee_size=10, test_mc_iters=10, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc=['BGD', 'on', 'continuous', 'permuted', 'mnist_3_tasks'], bw_to_rgb=False, permuted_offset=False, labels_trick=False, num_of_permutations=2, iterations_per_virtual_epc=469, separate_labels_space=False, permute_seed=2019)
[2024-05-16 08:30:12 Info] Computer name: iiitd with pytorch version: 2.2.2
[2024-05-16 08:30:13 Info] Transformed model to CUDA
[2024-05-16 08:30:13 Info] Initialized 2 Conv2d layers using nn.init.xavier_normal_
[2024-05-16 08:30:13 Info] Initialized 4 linear layers using xavier
[2024-05-16 08:30:13 Info] Initialized 2 bias conv2d layers using nn.init.xavier.noraml_
[2024-05-16 08:30:13 Info] Initialized 4 bias linear layers using xavier
[2024-05-16 08:30:13 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-05-16 08:30:13 Info] BGD params: {'mean_eta': 1, 'std_init': 0.06, 'mc_iters': 10}
[2024-05-16 08:30:13 Info] Inference method: {'init_std', 'committee', 'test_mc', 'map', 'agg_softmax'}
[2024-05-16 08:30:13 Info] Number of parameters in the model is 592,286
[2024-05-16 08:30:13 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-05-16 08:30:13 Info] Running training from epoch 1 to epoch 60
[2024-05-16 08:30:13 Info] Training epoch number 1 with dataset number 0
[2024-05-16 08:30:19 Info] Epoch 1, train set, Iter 100 current average loss 1.4100387828946137 current average acc 0.0%
[2024-05-16 08:30:23 Info] Epoch 1, train set, Iter 200 current average loss 0.8901302548274457 current average acc 0.0%
[2024-05-16 08:30:28 Info] Epoch 1, train set, Iter 300 current average loss 0.6747101928194412 current average acc 0.0%
[2024-05-16 08:30:33 Info] Epoch 1, train set, Iter 400 current average loss 0.554950374538082 current average acc 0.0%
[2024-05-16 08:30:37 Info] Stats for train set of size 60032, loss is 0.4968923589901775, acc is 0.0%
[2024-05-16 08:30:37 Info] Running test set for epoch number 1 for dataset idx 0 using init_std
[2024-05-16 08:30:38 Info] Stats for test [init_std] set of size 10000, loss is 0.1525700916178897, acc is 95.1719999999998%
[2024-05-16 08:30:38 Info] Running test set for epoch number 1 for dataset idx 1 using init_std
[2024-05-16 08:30:40 Info] Stats for test [init_std] set of size 10000, loss is 2.474078745193483, acc is 9.235000000000017%
[2024-05-16 08:30:40 Info] Running test set for epoch number 1 for dataset idx 2 using init_std
[2024-05-16 08:30:42 Info] Stats for test [init_std] set of size 10000, loss is 2.470849214096073, acc is 9.665000000000033%
[2024-05-16 08:30:42 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using init_std is 38.02399999999995
[2024-05-16 08:30:42 Info] Running test set for epoch number 1 for dataset idx 0 using committee
[2024-05-16 08:30:44 Info] Stats for test [committee] set of size 10000, loss is 0.10535176074117425, acc is 95.33%
[2024-05-16 08:30:44 Info] Running test set for epoch number 1 for dataset idx 1 using committee
[2024-05-16 08:30:47 Info] Stats for test [committee] set of size 10000, loss is 2.4509532243728636, acc is 8.250000000000002%
[2024-05-16 08:30:47 Info] Running test set for epoch number 1 for dataset idx 2 using committee
[2024-05-16 08:30:51 Info] Stats for test [committee] set of size 10000, loss is 2.452609756965636, acc is 9.419999999999995%
[2024-05-16 08:30:51 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using committee is 37.666666666666664
[2024-05-16 08:30:51 Info] Running test set for epoch number 1 for dataset idx 0 using test_mc
[2024-05-16 08:30:53 Info] Stats for test [test_mc] set of size 10000, loss is 0.10631761239040631, acc is 96.57300000000004%
[2024-05-16 08:30:53 Info] Running test set for epoch number 1 for dataset idx 1 using test_mc
[2024-05-16 08:30:55 Info] Stats for test [test_mc] set of size 10000, loss is 2.4561884616851817, acc is 9.25599999999998%
[2024-05-16 08:30:55 Info] Running test set for epoch number 1 for dataset idx 2 using test_mc
[2024-05-16 08:30:58 Info] Stats for test [test_mc] set of size 10000, loss is 2.4501035196304297, acc is 9.711999999999994%
[2024-05-16 08:30:58 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using test_mc is 38.51366666666667
[2024-05-16 08:30:58 Info] Running test set for epoch number 1 for dataset idx 0 using map
[2024-05-16 08:30:59 Info] Stats for test [map] set of size 10000, loss is 0.08441771686673165, acc is 97.08000000000001%
[2024-05-16 08:30:59 Info] Running test set for epoch number 1 for dataset idx 1 using map
[2024-05-16 08:31:03 Info] Stats for test [map] set of size 10000, loss is 2.403869338989258, acc is 8.500000000000004%
[2024-05-16 08:31:03 Info] Running test set for epoch number 1 for dataset idx 2 using map
[2024-05-16 08:31:05 Info] Stats for test [map] set of size 10000, loss is 2.4084516605377213, acc is 9.759999999999996%
[2024-05-16 08:31:05 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using map is 38.446666666666665
[2024-05-16 08:31:05 Info] Running test set for epoch number 1 for dataset idx 0 using agg_softmax
[2024-05-16 08:31:06 Info] Stats for test [agg_softmax] set of size 10000, loss is 0.10562452535718693, acc is 97.08%
[2024-05-16 08:31:06 Info] Running test set for epoch number 1 for dataset idx 1 using agg_softmax
[2024-05-16 08:31:08 Info] Stats for test [agg_softmax] set of size 10000, loss is 2.4549845413589493, acc is 8.710000000000004%
[2024-05-16 08:31:08 Info] Running test set for epoch number 1 for dataset idx 2 using agg_softmax
[2024-05-16 08:31:10 Info] Stats for test [agg_softmax] set of size 10000, loss is 2.452561627578732, acc is 9.700000000000003%
[2024-05-16 08:31:10 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using agg_softmax is 38.49666666666667
[2024-05-16 08:31:10 Info] Finished epoch number 1, Took 57 seconds
[2024-05-16 08:31:10 Info] Training epoch number 2 with dataset number 0
[2024-05-16 08:31:15 Info] Epoch 2, train set, Iter 100 current average loss 0.1374358739014714 current average acc 0.0%
[2024-05-16 08:31:20 Info] Epoch 2, train set, Iter 200 current average loss 0.12750495408102866 current average acc 0.0%
[2024-05-16 08:31:25 Info] Epoch 2, train set, Iter 300 current average loss 0.11666075547846681 current average acc 0.0%
[2024-05-16 08:31:30 Info] Epoch 2, train set, Iter 400 current average loss 0.11209182908758543 current average acc 0.0%
[2024-05-16 08:31:34 Info] Stats for train set of size 60032, loss is 0.10781470423381635, acc is 0.0%
[2024-05-16 08:31:34 Info] Running test set for epoch number 2 for dataset idx 0 using init_std
[2024-05-16 08:31:35 Info] Stats for test [init_std] set of size 10000, loss is 0.1097919103813917, acc is 96.49200000000005%
[2024-05-16 08:31:35 Info] Running test set for epoch number 2 for dataset idx 1 using init_std
[2024-05-16 08:31:37 Info] Stats for test [init_std] set of size 10000, loss is 2.4685757062530516, acc is 9.107%
[2024-05-16 08:31:37 Info] Running test set for epoch number 2 for dataset idx 2 using init_std
[2024-05-16 08:31:42 Info] Stats for test [init_std] set of size 10000, loss is 2.4879971080017063, acc is 9.671999999999997%
[2024-05-16 08:31:42 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using init_std is 38.423666666666676
[2024-05-16 08:31:42 Info] Running test set for epoch number 2 for dataset idx 0 using committee
[2024-05-16 08:31:43 Info] Stats for test [committee] set of size 10000, loss is 0.06725492963626983, acc is 96.83999999999999%
[2024-05-16 08:31:43 Info] Running test set for epoch number 2 for dataset idx 1 using committee
[2024-05-16 08:31:48 Info] Stats for test [committee] set of size 10000, loss is 2.448504097785948, acc is 7.999999999999998%
[2024-05-16 08:31:48 Info] Running test set for epoch number 2 for dataset idx 2 using committee
[2024-05-16 08:31:52 Info] Stats for test [committee] set of size 10000, loss is 2.464094582366947, acc is 9.969999999999999%
[2024-05-16 08:31:52 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using committee is 38.269999999999996
[2024-05-16 08:31:52 Info] Running test set for epoch number 2 for dataset idx 0 using test_mc
[2024-05-16 08:31:54 Info] Stats for test [test_mc] set of size 10000, loss is 0.06660736461792147, acc is 97.7850000000001%
[2024-05-16 08:31:54 Info] Running test set for epoch number 2 for dataset idx 1 using test_mc
[2024-05-16 08:31:56 Info] Stats for test [test_mc] set of size 10000, loss is 2.450642590370178, acc is 9.174999999999983%
[2024-05-16 08:31:56 Info] Running test set for epoch number 2 for dataset idx 2 using test_mc
