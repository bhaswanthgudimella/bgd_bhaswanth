[2024-05-22 06:50:46 Info] Script args: Namespace(n_tasks=3, n_classes=10, dataset='ds_cont_permuted_mnist', nn_arch='custom_cnn', logname='continuous_permuted_mnist_3tasks', results_dir='res', seed=2019, num_workers=1, num_epochs=9, batch_size=128, pruning_percents=[], train_mc_iters=10, std_init=0.06, mean_eta=1, permanent_prune_on_epoch=-1, permanent_prune_on_epoch_percent=90, test_freq=1, contpermuted_beta=4, optimizer='bgd', optimizer_params='{}', inference_mc=False, inference_map=False, inference_committee=True, inference_aggsoftmax=False, inference_initstd=False, committee_size=10, test_mc_iters=0, init_params=['{"bias_type":', '"xavier",', '"conv_type":', '"xavier",', '"bn_init":', '"01"}'], desc=['BGD', 'on', 'continuous', 'permuted', 'mnist'], bw_to_rgb=False, permuted_offset=False, labels_trick=True, num_of_permutations=2, iterations_per_virtual_epc=469, separate_labels_space=True, permute_seed=2019)
[2024-05-22 06:50:46 Info] Computer name: iiitd with pytorch version: 2.2.2
[2024-05-22 06:50:46 Info] Transformed model to CUDA
[2024-05-22 06:50:46 Info] Initialized 2 Conv2d layers using nn.init.xavier_normal_
[2024-05-22 06:50:46 Info] Initialized 4 linear layers using xavier
[2024-05-22 06:50:46 Info] Initialized 2 bias conv2d layers using nn.init.xavier.noraml_
[2024-05-22 06:50:46 Info] Initialized 4 bias linear layers using xavier
[2024-05-22 06:50:46 Info] Initialized 0 BN layers using weight=1 and bias=0
[2024-05-22 06:50:46 Info] BGD params: {'mean_eta': 1, 'std_init': 0.06, 'mc_iters': 10}
[2024-05-22 06:50:46 Info] Inference method: {'committee'}
[2024-05-22 06:50:46 Info] Number of parameters in the model is 592,286
[2024-05-22 06:50:46 Info] Criterion parameters: type=<class 'torch.nn.modules.loss.CrossEntropyLoss'>
[2024-05-22 06:50:46 Info] Running training from epoch 1 to epoch 9
[2024-05-22 06:50:46 Info] Training epoch number 1 with dataset number 0
[2024-05-22 06:50:51 Info] Epoch 1, train set, Iter 100 current average loss 1.4257816490828998 current average acc 0.0%
[2024-05-22 06:50:54 Info] Epoch 1, train set, Iter 200 current average loss 0.9110199204683295 current average acc 0.0%
[2024-05-22 06:50:57 Info] Epoch 1, train set, Iter 300 current average loss 0.6963681993434825 current average acc 0.0%
[2024-05-22 06:51:01 Info] Epoch 1, train set, Iter 400 current average loss 0.5716683747917417 current average acc 0.0%
[2024-05-22 06:51:04 Info] Stats for train set of size 60032, loss is 0.511544195162274, acc is 0.0%
[2024-05-22 06:51:04 Info] Running test set for epoch number 1 for dataset idx 0 using committee
[2024-05-22 06:51:05 Info] Stats for test [committee] set of size 10000, loss is 0.1204483809116481, acc is 94.81999999999994%
[2024-05-22 06:51:05 Info] Running test set for epoch number 1 for dataset idx 1 using committee
[2024-05-22 06:51:07 Info] Stats for test [committee] set of size 10000, loss is 2.4576424686813376, acc is 8.830000000000002%
[2024-05-22 06:51:07 Info] Running test set for epoch number 1 for dataset idx 2 using committee
[2024-05-22 06:51:08 Info] Stats for test [committee] set of size 10000, loss is 2.4400685201263412, acc is 9.97%
[2024-05-22 06:51:08 Info] Average accuracy over all tasks for epoch number 1 for dataset idx 2 using committee is 37.873333333333306
[2024-05-22 06:51:08 Info] Finished epoch number 1, Took 21 seconds
[2024-05-22 06:51:08 Info] Training epoch number 2 with dataset number 0
[2024-05-22 06:51:14 Info] Epoch 2, train set, Iter 100 current average loss 0.1428401008360085 current average acc 0.0%
[2024-05-22 06:51:19 Info] Epoch 2, train set, Iter 200 current average loss 0.13156825306825337 current average acc 0.0%
[2024-05-22 06:51:23 Info] Epoch 2, train set, Iter 300 current average loss 0.12376612997675947 current average acc 0.0%
[2024-05-22 06:51:28 Info] Epoch 2, train set, Iter 400 current average loss 0.11874510079715395 current average acc 0.0%
[2024-05-22 06:51:32 Info] Stats for train set of size 60032, loss is 0.11520592047969895, acc is 0.0%
[2024-05-22 06:51:32 Info] Running test set for epoch number 2 for dataset idx 0 using committee
[2024-05-22 06:51:33 Info] Stats for test [committee] set of size 10000, loss is 0.06462595379708316, acc is 97.29000000000003%
[2024-05-22 06:51:33 Info] Running test set for epoch number 2 for dataset idx 1 using committee
[2024-05-22 06:51:34 Info] Stats for test [committee] set of size 10000, loss is 2.477001893806461, acc is 8.690000000000005%
[2024-05-22 06:51:34 Info] Running test set for epoch number 2 for dataset idx 2 using committee
[2024-05-22 06:51:36 Info] Stats for test [committee] set of size 10000, loss is 2.4630911380004874, acc is 10.000000000000002%
[2024-05-22 06:51:36 Info] Average accuracy over all tasks for epoch number 2 for dataset idx 2 using committee is 38.66000000000002
[2024-05-22 06:51:36 Info] Finished epoch number 2, Took 27 seconds
[2024-05-22 06:51:36 Info] Training epoch number 3 with dataset number 0
[2024-05-22 06:51:40 Info] Epoch 3, train set, Iter 100 current average loss 0.08896820177324127 current average acc 0.0%
[2024-05-22 06:51:45 Info] Epoch 3, train set, Iter 200 current average loss 0.14482903898879915 current average acc 0.0%
[2024-05-22 06:51:48 Info] Epoch 3, train set, Iter 300 current average loss 0.24354517148186786 current average acc 0.0%
[2024-05-22 06:51:51 Info] Epoch 3, train set, Iter 400 current average loss 0.31313591548241615 current average acc 0.0%
[2024-05-22 06:51:53 Info] Stats for train set of size 60032, loss is 0.34389265869885066, acc is 0.0%
[2024-05-22 06:51:53 Info] Running test set for epoch number 3 for dataset idx 0 using committee
[2024-05-22 06:51:54 Info] Stats for test [committee] set of size 10000, loss is 0.06457137297476641, acc is 96.72%
[2024-05-22 06:51:54 Info] Running test set for epoch number 3 for dataset idx 1 using committee
[2024-05-22 06:51:56 Info] Stats for test [committee] set of size 10000, loss is 2.583037135353091, acc is 9.759999999999994%
[2024-05-22 06:51:56 Info] Running test set for epoch number 3 for dataset idx 2 using committee
[2024-05-22 06:51:58 Info] Stats for test [committee] set of size 10000, loss is 2.507713269996644, acc is 7.820000000000003%
[2024-05-22 06:51:58 Info] Average accuracy over all tasks for epoch number 3 for dataset idx 2 using committee is 38.1
[2024-05-22 06:51:58 Info] Finished epoch number 3, Took 21 seconds
[2024-05-22 06:51:58 Info] Training epoch number 4 with dataset number 0
[2024-05-22 06:52:02 Info] Epoch 4, train set, Iter 100 current average loss 0.49418906578421645 current average acc 0.0%
[2024-05-22 06:52:06 Info] Epoch 4, train set, Iter 200 current average loss 0.4918268138915309 current average acc 0.0%
[2024-05-22 06:52:09 Info] Epoch 4, train set, Iter 300 current average loss 0.48365898207823566 current average acc 0.0%
[2024-05-22 06:52:12 Info] Epoch 4, train set, Iter 400 current average loss 0.47709976513684 current average acc 0.0%
[2024-05-22 06:52:15 Info] Stats for train set of size 60032, loss is 0.47036526660675343, acc is 0.0%
[2024-05-22 06:52:15 Info] Running test set for epoch number 4 for dataset idx 0 using committee
[2024-05-22 06:52:16 Info] Stats for test [committee] set of size 10000, loss is 0.09424461822057155, acc is 95.08999999999995%
[2024-05-22 06:52:16 Info] Running test set for epoch number 4 for dataset idx 1 using committee
[2024-05-22 06:52:18 Info] Stats for test [committee] set of size 10000, loss is 2.611121529960632, acc is 10.379999999999995%
[2024-05-22 06:52:18 Info] Running test set for epoch number 4 for dataset idx 2 using committee
[2024-05-22 06:52:19 Info] Stats for test [committee] set of size 10000, loss is 2.506242436981198, acc is 8.970000000000006%
[2024-05-22 06:52:19 Info] Average accuracy over all tasks for epoch number 4 for dataset idx 2 using committee is 38.14666666666665
[2024-05-22 06:52:19 Info] Finished epoch number 4, Took 21 seconds
[2024-05-22 06:52:19 Info] Training epoch number 5 with dataset number 0
[2024-05-22 06:52:23 Info] Epoch 5, train set, Iter 100 current average loss 0.3814326596111062 current average acc 0.0%
[2024-05-22 06:52:26 Info] Epoch 5, train set, Iter 200 current average loss 0.3669929363131517 current average acc 0.0%
[2024-05-22 06:52:29 Info] Epoch 5, train set, Iter 300 current average loss 0.35733935106297277 current average acc 0.0%
[2024-05-22 06:52:32 Info] Epoch 5, train set, Iter 400 current average loss 0.34883561860024775 current average acc 0.0%
[2024-05-22 06:52:34 Info] Stats for train set of size 60032, loss is 0.3423866651205604, acc is 0.0%
[2024-05-22 06:52:34 Info] Running test set for epoch number 5 for dataset idx 0 using committee
[2024-05-22 06:52:35 Info] Stats for test [committee] set of size 10000, loss is 0.16028795390255765, acc is 91.62000000000002%
[2024-05-22 06:52:35 Info] Running test set for epoch number 5 for dataset idx 1 using committee
[2024-05-22 06:52:37 Info] Stats for test [committee] set of size 10000, loss is 2.638720459899908, acc is 9.380000000000003%
[2024-05-22 06:52:37 Info] Running test set for epoch number 5 for dataset idx 2 using committee
[2024-05-22 06:52:39 Info] Stats for test [committee] set of size 10000, loss is 2.522632574081412, acc is 9.62%
[2024-05-22 06:52:39 Info] Average accuracy over all tasks for epoch number 5 for dataset idx 2 using committee is 36.87333333333334
[2024-05-22 06:52:39 Info] Finished epoch number 5, Took 19 seconds
[2024-05-22 06:52:39 Info] Training epoch number 6 with dataset number 0
[2024-05-22 06:52:42 Info] Epoch 6, train set, Iter 100 current average loss 0.30392228202521804 current average acc 0.0%
[2024-05-22 06:52:46 Info] Epoch 6, train set, Iter 200 current average loss 0.3563051814809451 current average acc 0.0%
[2024-05-22 06:52:49 Info] Epoch 6, train set, Iter 300 current average loss 0.41651824267208604 current average acc 0.0%
[2024-05-22 06:52:53 Info] Epoch 6, train set, Iter 400 current average loss 0.45188913031294925 current average acc 0.0%
[2024-05-22 06:52:55 Info] Stats for train set of size 60032, loss is 0.4627888621202409, acc is 0.0%
[2024-05-22 06:52:55 Info] Running test set for epoch number 6 for dataset idx 0 using committee
[2024-05-22 06:52:56 Info] Stats for test [committee] set of size 10000, loss is 0.3615934758970139, acc is 81.84999999999998%
[2024-05-22 06:52:56 Info] Running test set for epoch number 6 for dataset idx 1 using committee
[2024-05-22 06:52:58 Info] Stats for test [committee] set of size 10000, loss is 2.6232681599044767, acc is 9.750000000000002%
[2024-05-22 06:52:58 Info] Running test set for epoch number 6 for dataset idx 2 using committee
[2024-05-22 06:52:59 Info] Stats for test [committee] set of size 10000, loss is 2.6067133441543584, acc is 3.6299999999999986%
[2024-05-22 06:52:59 Info] Average accuracy over all tasks for epoch number 6 for dataset idx 2 using committee is 31.74333333333333
[2024-05-22 06:52:59 Info] Finished epoch number 6, Took 20 seconds
[2024-05-22 06:52:59 Info] Training epoch number 7 with dataset number 0
[2024-05-22 06:53:04 Info] Epoch 7, train set, Iter 100 current average loss 0.4988503764271735 current average acc 0.0%
[2024-05-22 06:53:07 Info] Epoch 7, train set, Iter 200 current average loss 0.4917055746316909 current average acc 0.0%
[2024-05-22 06:53:10 Info] Epoch 7, train set, Iter 300 current average loss 0.48491082502404814 current average acc 0.0%
[2024-05-22 06:53:13 Info] Epoch 7, train set, Iter 400 current average loss 0.4680989894531657 current average acc 0.0%
[2024-05-22 06:53:16 Info] Stats for train set of size 60032, loss is 0.4569117409619938, acc is 0.0%
[2024-05-22 06:53:16 Info] Running test set for epoch number 7 for dataset idx 0 using committee
[2024-05-22 06:53:17 Info] Stats for test [committee] set of size 10000, loss is 0.7352312197595832, acc is 70.44999999999995%
[2024-05-22 06:53:17 Info] Running test set for epoch number 7 for dataset idx 1 using committee
[2024-05-22 06:53:18 Info] Stats for test [committee] set of size 10000, loss is 2.6116246987533542, acc is 9.669999999999996%
[2024-05-22 06:53:18 Info] Running test set for epoch number 7 for dataset idx 2 using committee
[2024-05-22 06:53:20 Info] Stats for test [committee] set of size 10000, loss is 2.733508995742795, acc is 3.6700000000000013%
[2024-05-22 06:53:20 Info] Average accuracy over all tasks for epoch number 7 for dataset idx 2 using committee is 27.929999999999982
[2024-05-22 06:53:20 Info] Finished epoch number 7, Took 20 seconds
[2024-05-22 06:53:20 Info] Training epoch number 8 with dataset number 0
[2024-05-22 06:53:24 Info] Epoch 8, train set, Iter 100 current average loss 0.3556173609197131 current average acc 0.0%
[2024-05-22 06:53:27 Info] Epoch 8, train set, Iter 200 current average loss 0.3369160597249865 current average acc 0.0%
[2024-05-22 06:53:30 Info] Epoch 8, train set, Iter 300 current average loss 0.3334107378919917 current average acc 0.0%
[2024-05-22 06:53:33 Info] Epoch 8, train set, Iter 400 current average loss 0.32796726674586485 current average acc 0.0%
[2024-05-22 06:53:35 Info] Stats for train set of size 60032, loss is 0.323355940386239, acc is 0.0%
[2024-05-22 06:53:35 Info] Running test set for epoch number 8 for dataset idx 0 using committee
[2024-05-22 06:53:36 Info] Stats for test [committee] set of size 10000, loss is 0.8670486056470877, acc is 66.83999999999999%
[2024-05-22 06:53:36 Info] Running test set for epoch number 8 for dataset idx 1 using committee
[2024-05-22 06:53:38 Info] Stats for test [committee] set of size 10000, loss is 2.573638143157957, acc is 10.320000000000002%
[2024-05-22 06:53:38 Info] Running test set for epoch number 8 for dataset idx 2 using committee
[2024-05-22 06:53:39 Info] Stats for test [committee] set of size 10000, loss is 2.7507606519317616, acc is 2.519999999999999%
[2024-05-22 06:53:39 Info] Average accuracy over all tasks for epoch number 8 for dataset idx 2 using committee is 26.56
[2024-05-22 06:53:39 Info] Finished epoch number 8, Took 19 seconds
[2024-05-22 06:53:39 Info] Training epoch number 9 with dataset number 0
[2024-05-22 06:53:43 Info] Epoch 9, train set, Iter 100 current average loss 0.2792455061376089 current average acc 0.0%
[2024-05-22 06:53:45 Info] Epoch 9, train set, Iter 200 current average loss 0.2725747017227108 current average acc 0.0%
[2024-05-22 06:53:48 Info] Epoch 9, train set, Iter 300 current average loss 0.26979227605710426 current average acc 0.0%
[2024-05-22 06:53:51 Info] Epoch 9, train set, Iter 400 current average loss 0.2670969015173617 current average acc 0.0%
[2024-05-22 06:53:53 Info] Stats for train set of size 60032, loss is 0.2625204841465321, acc is 0.0%
[2024-05-22 06:53:53 Info] Running test set for epoch number 9 for dataset idx 0 using committee
[2024-05-22 06:53:54 Info] Stats for test [committee] set of size 10000, loss is 1.056195200841428, acc is 63.71000000000001%
[2024-05-22 06:53:54 Info] Running test set for epoch number 9 for dataset idx 1 using committee
[2024-05-22 06:53:56 Info] Stats for test [committee] set of size 10000, loss is 2.5650231435775748, acc is 10.390000000000006%
[2024-05-22 06:53:56 Info] Running test set for epoch number 9 for dataset idx 2 using committee
[2024-05-22 06:53:58 Info] Stats for test [committee] set of size 10000, loss is 2.7789704846191383, acc is 2.6100000000000003%
[2024-05-22 06:53:58 Info] Average accuracy over all tasks for epoch number 9 for dataset idx 2 using committee is 25.570000000000004
[2024-05-22 06:53:58 Info] Finished epoch number 9, Took 18 seconds
